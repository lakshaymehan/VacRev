<% layout('/layouts/boilerplate') %>
<div class="container" style="width:600px;">
  <h2 align="center">Centers In Your Area </h2><br /><br />

<div id="name">

</div>

</div>


<script>  
$(document).ready(()=>{
  let d = new Date();
  let month = d.getMonth()+1;
  let day = d.getDate();
  let districtsId = document.cookie.split('=')[1];
  let output = (day<10 ? '0' : '') + day + '-' +(month<10 ? '0' : '') + month + '-'+ d.getFullYear() ;
  $.get(`https://cdn-api.co-vin.in/api/v2/appointment/sessions/public/calendarByDistrict?district_id=${districtsId}&date=${output}`,(data)=>{
      if(data.centers.length === 0)
      {
        $('#name').append("<p>No Centers Available in this District</p>");
      }
      for(center of data.centers)
      { 
        $('#name').append(`<div class="card mb-3">
                              <h5 class="card-header">${center.name}</h5>

                              <div class="card-body"> 
                                <p class="card-title fw-bold">${center.address} ${center.pincode}</p>
                                <p class="card-title"><b>Vaccine: </b>${center.sessions[0].vaccine} <b>Price: </b>${center.fee_type}</p>
                                <button sid="center" value="${center.center_id}"class="btn btn-primary">Go somewhere</button>
                                </div>
                              
                          </div>
                              `);
      }

  })
})
</script>